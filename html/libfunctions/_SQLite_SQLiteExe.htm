<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Function _SQLite_SQLiteExe</title>
  <meta http-equiv="Content-Type" content="text/html; charset=shift-jis">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">_SQLite_SQLiteExe</font>
<hr size="2">
<p>SQLite.exeのコマンドを実行します。<br></p>

<p class="codeheader">
#include &lt;SQLite.au3&gt;<br>
_SQLite_SQLiteExe ( $sDatabaseFile, $sInput, ByRef $sOutput [, $sSQLiteExeFilename = "SQLite3.exe" ] )<br>
</p>
<p>&nbsp;</p>

<p><b>パラメータ</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">$sDatabaseFile</td>
    <td width="85%">データベースファイル名</td>
  </tr>
  <tr>
   <td>$sInput</td>
   <td>SQLite.exeのコマンド</td>
  </tr>
  <tr>
   <td>$sOutput</td>
   <td>SQLite.exeからの行出力</td>
  </tr>
  <tr>
   <td>$sSQLiteExeFilename</td>
   <td><b>[オプション]</b>SQlite.exeのパス</td>
  </tr>
  <tr>
   <td></td>
   <td></td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b>返し値</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">成功:</td>
    <td width="90%">$SQLITE_OKを返します</td>
  </tr>
  <tr>
    <td valign="top">失敗:</td>
    <td>$SQLITE_* 定数と比較可能な値を返します</td>
  </tr>
  <tr>
    <td valign="top">@error:</td>
    <td>1 - 新しいデータベースを作成できません</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>2 - SQLite3.exeがみつかりません</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>3 - SQLエラー / 不完全なSQL</td>
  </tr>
  <tr>
    <td valign="top"> </td>
    <td>4 - 入力ファイルを開けません</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>注意</b></p>
SQLite3.exeのコマンドに関する詳しい情報を得るにはSQLite.exeを実行し、エンターを押して.Helpと入力してください。<br>
<br>
SQLite3.exeはSQLiteのウェブサイトで手に入ります。ヘルプファイルのコピーはAutoIt3\Extras\SQLiteディレクトリにあります。<br>
<br>
<p>&nbsp;</p>

<p><b>関連</b></p>
None.
<p>&nbsp;</p>

<p><b>例</b></p>
<p class="codebox">
<br>
<span><span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;SQLite.au3&gt;</span><br>
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;SQLite.dll.au3&gt;</span><br>
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;file.au3&gt;</span><br>
<br>
<span class="S1">;ファイル名</span><br>
<span class="S5">Local</span><span class="S0"> </span><span class="S9">$sTsvFile</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">FileGetShortName</span><span class="S8">(</span><span class="S15">_TempFile</span><span class="S8">(</span><span class="S6">@ScriptDir</span><span class="S8">,</span><span class="S7">"~"</span><span class="S8">,</span><span class="S7">".tsv"</span><span class="S8">))</span><br>
<span class="S5">Local</span><span class="S0"> </span><span class="S9">$sDbFile</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">FileGetShortName</span><span class="S8">(</span><span class="S15">_TempFile</span><span class="S8">(</span><span class="S6">@ScriptDir</span><span class="S8">,</span><span class="S7">"~"</span><span class="S8">,</span><span class="S7">".db"</span><span class="S8">))</span><br>
<br>
<span class="S1">;Tsvファイル作成</span><br>
<span class="S4">FileWriteLine</span><span class="S8">(</span><span class="S9">$sTsvFile</span><span class="S8">,</span><span class="S7">"a"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"b"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"c"</span><span class="S8">)</span><br>
<span class="S4">FileWriteLine</span><span class="S8">(</span><span class="S9">$sTsvFile</span><span class="S8">,</span><span class="S7">"a1"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"b1"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"c1"</span><span class="S8">)</span><br>
<span class="S4">FileWriteLine</span><span class="S8">(</span><span class="S9">$sTsvFile</span><span class="S8">,</span><span class="S7">"a2"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"b2"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"c2"</span><span class="S8">)</span><br>
<br>
<span class="S1">;インポート(SQLite3.exeを使用)</span><br>
<span class="S5">Local</span><span class="S0"> </span><span class="S9">$sIn</span><span class="S8">,</span><span class="S9">$sOut</span><span class="S8">,</span><span class="S9">$i</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sCreate</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"CREATE TABLE TblImport ("</span><span class="S1">;</span><br>
<span class="S5">for</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> _StringCountOccurance</span><span class="S8">(</span><span class="S4">FileReadLine</span><span class="S8">(</span><span class="S9">$sTsvFile</span><span class="S8">,</span><span class="S3">1</span><span class="S8">),</span><span class="S6">@TAB</span><span class="S8">)</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$sCreate</span><span class="S0"> </span><span class="S8">&amp;=</span><span class="S0"> </span><span class="S7">"Column_"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">","</span><br>
<span class="S5">Next</span><br>
<span class="S9">$sCreate</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">StringTrimRight</span><span class="S8">(</span><span class="S9">$sCreate</span><span class="S8">,</span><span class="S3">1</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">");"</span><br>
<span class="S9">$sIn</span><span class="S0"> &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$sCreate</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S0"> </span><span class="S1">; テーブル作成</span><br>
<span class="S9">$sIn</span><span class="S0"> </span><span class="S8">&amp;=</span><span class="S0"> </span><span class="S7">".separator \t"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S0"> </span><span class="S1">; 区切りとして@TABを選択</span><br>
<span class="S9">$sIn</span><span class="S0"> </span><span class="S8">&amp;=</span><span class="S0"> </span><span class="S7">".import '"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sTsvFile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"' TblImport"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><br>
<span class="S15">_SQLite_SQLiteExe</span><span class="S8">(</span><span class="S9">$sDbFile</span><span class="S8">,</span><span class="S9">$sIn</span><span class="S8">,</span><span class="S9">$sOut</span><span class="S8">,-</span><span class="S3">1</span><span class="S8">,</span><span class="S5">true</span><span class="S8">)</span><br>
<br>
<span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">;テーブル表示(SQLite3.dllを使用)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$iRows</span><span class="S8">,</span><span class="S9">$iColumns</span><span class="S8">,</span><span class="S9">$aRes</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S15">_SQLite_Startup</span><span class="S8">()</span><br>
<span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"_SQLite_LibVersion="</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S15">_SQLite_LibVersion</span><span class="S8">()</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S15">_SQLite_Open</span><span class="S8">(</span><span class="S9">$sDbFile</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S15">_SQLite_GetTable2d</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S7">"SELECT ROWID,* FROM TblImport;"</span><span class="S8">,</span><span class="S9">$aRes</span><span class="S8">,</span><span class="S9">$iRows</span><span class="S8">,</span><span class="S9">$iColumns</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S15">_SQLite_Display2DResult</span><span class="S8">(</span><span class="S9">$aRes</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; コンソール出力</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S15">_SQLite_Close</span><span class="S8">()</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S15">_SQLite_Shutdown</span><span class="S8">()</span><br>
<span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">2</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"ERROR: Sqlite3.exe file not found"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"ERROR: @error="</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" when calling _SQLite_SQLiteExe"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S5">EndIf</span><br>
<br>
<span class="S1">;一時ファイル削除</span><br>
<span class="S4">FileDelete</span><span class="S8">(</span><span class="S9">$sTsvFile</span><span class="S8">)</span><br>
<span class="S4">FileDelete</span><span class="S8">(</span><span class="S9">$sDbFile</span><span class="S8">)</span><br>
<br>
<span class="S1">;~ 出力:</span><br>
<span class="S1">;~ &nbsp;rowid &nbsp;Column_1 &nbsp;Column_2 &nbsp;Column_3</span><br>
<span class="S1">;~ &nbsp;1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c</span><br>
<span class="S1">;~ &nbsp;2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1</span><br>
<span class="S1">;~ &nbsp;3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2</span><br>
<br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> _StringCountOccurance</span><span class="S8">(</span><span class="S9">$sSearchString</span><span class="S8">,</span><span class="S9">$sSubString</span><span class="S8">,</span><span class="S9">$fCaseSense</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; $sSearchString内の$sSubStringの数を返す</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$iOccCnt</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Do</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">StringInStr</span><span class="S8">(</span><span class="S9">$sSearchString</span><span class="S8">,</span><span class="S9">$sSubString</span><span class="S8">,</span><span class="S9">$fCaseSense</span><span class="S8">,</span><span class="S9">$iOccCnt</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iOccCnt</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">ExitLoop</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Until</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$iOccCnt</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S5">EndFunc</span><br>
<span class="S0"></span></span><br>
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i))
document.write('<br><OBJECT id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" width=58 height=57><PARAM name="Command" value="ShortCut"><PARAM name="Button" value="Text:Open this Script"><PARAM name="Item1" value=",Examples\\HelpFile\\_SQLite_SQLiteExe.au3,"></OBJECT>');
</script>
<p>&nbsp;</p>

</body>
</html>
