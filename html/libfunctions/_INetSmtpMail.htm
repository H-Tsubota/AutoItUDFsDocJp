<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Function _INetSmtpMail</title>
  <meta http-equiv="Content-Type" content="text/html; charset=shift-jis">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">_INetSmtpMail</font>
<hr size="2">
<p>外部のeメールプログラムを使用せずにeメールを送信します。<br></p>

<p class="codeheader">
#include &lt;INet.au3&gt;<br>
_INetSmtpMail ( $s_SmtpServer, $s_FromName, $s_FromAddress, $s_ToAddress [,$s_Subject [,$as_Body [,$s_helo [,$s_first [,$b_trace]]]]])<br>
</p>
<p>&nbsp;</p>

<p><b>パラメータ</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">$s_SmtpServer</td>
    <td width="85%">	eメール送信に使用するSMTPサーバー。通常はアルファベットまたは数値によるIPアドレス。スパムを防ぐために多くのISPではサーバーがこれを要求します。<br>
       例: "smtp.ispdomain.com"、"mail.ispdomain.com"、"192.168.1.1"</td>
  </tr>
  <tr>
   <td>$s_FromName</td>
   <td>メッセージに送信者として表示したい名前。<br>
       例: "Bob Smith"</td>
  </tr>
  <tr>
   <td>$s_FromAddress</td>
   <td>メッセージに送信者として表示したいeメールアドレス。<br>
       例: "bob.smith@mydomain.com".</td>
  </tr>
  <tr>
   <td>$s_ToAddress</td>
   <td>メッセージ送信先のeメールアドレス。<br>
       例: "jane.brown@yourdomain.com"</td>
  </tr>
  <tr>
   <td>$s_Subject</td>
   <td><b>[オプション]</b> eメールの件名。</td>
  </tr>
  <tr>
   <td>$as_Body</td>
   <td><b>[オプション]</b> eメールの本文。文字列の1次元配列。eメール内では配列内の各値の末端に@CRLFが付加されます。</td>
  </tr>
  <tr>
   <td>$s_helo</td>
   <td><b>[オプション]</b> SMTPサーバー接続の識別子(デフォルトでは@ComputerName)。SMTPサーバーが"EHLO"を要求する場合は"EHLO " & @ComputerNameを設定します。</td>
  </tr>
  <tr>
   <td>$s_first</td>
   <td><b>[オプション]</b> SMTPサーバー接続時にheloの前に送信する文字列(デフォルトは{SPACE})。何も送信しない場合はこのパラメータを-1に設定してください。SMTPサーバーによっては何も送信してはいけない場合があります。</td>
  </tr>
  <tr>
   <td>$b_trace</td>
   <td><b>[オプション]</b> スプラッシュウィンドウのダイアログを表示<br>
       </td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b>返し値</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">成功:</td>
    <td width="90%">1を返します。</td>
  </tr>
  <tr>
    <td valign="top">失敗:</td>
    <td>0を返し、@errorを設定します。</td>
  </tr>
  <tr>
    <td valign="top">@error:</td>
    <td>1    - 無効なパラメータです</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>2    - TCPが開始できません</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>3    - IPが解決できません</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>4    - ソケットが作成できません</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>5x   - SMTPセッションが開けません。xはSMTPサーバーに対して発行した最後のコマンドのインデックス番号を表します。</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>50x  - 本文を送信できません。xは$as_Bodyの行番号(0始まり)を表します。</td>
  </tr>
  <tr>
    <td valign="top"></td>
    <td>5000 - SMTPセッションが閉じられません</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>注意</b></p>
この関数はサードパーティーのeメールクライアントを使用せずにeメールを直接SMTPサーバーに送信します。AutoIt3 v 3.1.1.97以降が必要です。<br>
<br>
<p>&nbsp;</p>

<p><b>関連</b></p>
<a href="_INetMail.htm">_INetMail</a>
<p>&nbsp;</p>

<p><b>例</b></p>
<p class="codebox">
<br>
<span><span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;INet.au3&gt;</span><br>
<br>
<span class="S9">$s_SmtpServer</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"mysmtpserver.com.au"</span><br>
<span class="S9">$s_FromName</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"My Name"</span><br>
<span class="S9">$s_FromAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"From eMail Address"</span><br>
<span class="S9">$s_ToAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"To eMail Address"</span><br>
<span class="S9">$s_Subject</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"My Test UDF"</span><br>
<span class="S5">Dim</span><span class="S0"> </span><span class="S9">$as_Body</span><span class="S8">[</span><span class="S3">2</span><span class="S8">]</span><br>
<span class="S9">$as_Body</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Testing the new email udf"</span><br>
<span class="S9">$as_Body</span><span class="S8">[</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Second Line"</span><br>
<span class="S9">$Response</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S15">_INetSmtpMail</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$s_SmtpServer</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$s_FromName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$s_FromAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$s_ToAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$s_Subject</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$as_Body</span><span class="S8">)</span><br>
<span class="S9">$err</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S6">@error</span><br>
<span class="S5">If</span><span class="S0"> </span><span class="S9">$Response</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Success!"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Mail sent"</span><span class="S8">)</span><br>
<span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Error!"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Mail failed with error code "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$err</span><span class="S8">)</span><br>
<span class="S5">EndIf</span><br>
<span class="S0"></span></span><br>
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i))
document.write('<br><OBJECT id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" width=58 height=57><PARAM name="Command" value="ShortCut"><PARAM name="Button" value="Text:Open this Script"><PARAM name="Item1" value=",Examples\\HelpFile\\_INetSmtpMail.au3,"></OBJECT>');
</script>
<p>&nbsp;</p>

</body>
</html>
